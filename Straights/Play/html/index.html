<!DOCTYPE html>
<!--
SPDX-FileCopyrightText: 2020 Luis Walter, 2025 Moritz Ringler

SPDX-License-Identifier: GPL-3.0-or-later
-->

<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="author" content="Moritz Ringler">
    <meta name="keywords" content="Straights, Str8ts, Puzzle, Game, Grid">
    <meta name="description" content="Play Straights online without ads.">
    <title>Str8ts</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="./str8ts.css">
    <link rel="icon" type="image/x-icon" href="./favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="./favicon/favicon-48x48.png">
    <link rel="icon" type="image/png" sizes="64x64" href="./favicon/favicon-64x64.png">
    <link rel="icon" type="image/png" sizes="128x128" href="./favicon/favicon-128x128.png">
    <link rel="icon" type="image/png" sizes="256x256" href="./favicon/favicon-256x256.png">
    <link rel="apple-touch-icon" sizes="192x192" href="./favicon/maskable_icon_x192.png">
    <link rel="manifest" href="./site.webmanifest">
</head>
<body>
    <script src="jquery-3.7.1.min.js" ></script>
    <div class="wrapper">
        <table class="container" cellspacing="0"></table>
        <div class="controls">
            <table cellspacing="5" id="buttons-small">
                <tr>
                    <td class="button num-small" data-button="bn1"  id="sbn1" >1</td>
                    <td class="button num-small" data-button="bn2"  id="sbn2" >2</td>
                    <td class="button num-small" data-button="bn3"  id="sbn3" >3</td>
                    <td class="button num-small" data-button="bn4"  id="sbn4" >4</td>
                    <td class="button num-small" data-button="bn5"  id="sbn5" >5</td>
                    <td class="button num-small" data-button="bn6"  id="sbn6" >6</td>
                    <td class="button num-small" data-button="bn7"  id="sbn7" >7</td>
                    <td class="button num-small" data-button="bn8"  id="sbn8" >8</td>
                    <td class="button num-small" data-button="bn9"  id="sbn9" >9</td>
                    <td class="button num-small" data-button="bn10" id="sbn10">10</td>
                    <td class="button num-small" data-button="bn11" id="sbn11">11</td>
                    <td class="button num-small" data-button="bn12" id="sbn12">12</td>
                </tr>
            </table>
            <table cellspacing="7" id="buttons-large">
                <tr>
                    <td class="button num" data-button="bn1" id="bn1">1</td>
                    <td class="button num" data-button="bn2" id="bn2">2</td>
                    <td class="button num" data-button="bn3" id="bn3">3</td>
                </tr>
                <tr>
                    <td class="button num" data-button="bn4" id="bn4">4</td>
                    <td class="button num" data-button="bn5" id="bn5">5</td>
                    <td class="button num" data-button="bn6" id="bn6">6</td>
                </tr>
                <tr>
                    <td class="button num" data-button="bn7" id="bn7">7</td>
                    <td class="button num" data-button="bn8" id="bn8">8</td>
                    <td class="button num" data-button="bn9" id="bn9">9</td>
                </tr>
                <tr>
                    <td class="button num" data-button="bn10" id="bn10">10</td>
                    <td class="button num" data-button="bn11" id="bn11">11</td>
                    <td class="button num" data-button="bn12" id="bn12">12</td>
                </tr>
            </table>
            <table cellspacing="7px">
                <tr>
                    <td class="button set" id="undo" title="Undo [Ctrl+Z]" onclick="undo()" disabled>‚éå</td>
                    <td class="button set" id="notes" title="Notes Mode [N]" onclick="toggleNoteMode()">üìù</td>
                </tr>
            </table>
            <table cellspacing="7px">
                <tr>
                    <td class="button set-slim" id="check" title="Check" onclick="check()">‚úÖÔ∏è</td>
                    <td class="button set-slim" id="hint" title="Hint" onclick="hint()">üí°</td>
                    <td class="button set-slim" id="delete" title="Show solution" onclick="showDialog(dialogs.SOLUTION)">üëÄ</td>
                </tr>
                <tr>
                    <td class="counter-text set-slim" id="check-counter">0</td>
                    <td class="counter-text set-slim" id="hint-counter">0</td>
                    <td class="counter-text set-slim" id="time">00:00</td>
                </tr>
            </table>
            <table cellspacing="7px">
                <tr>
                    <td class="button set-slim" id="new" title="New game" onclick="loadNewGameAgain()">‚ú®</td>
                    <td class="button set-slim" id="restart" title="Start over" onclick="showDialog(dialogs.RESTART)">‚ü≥</td>
                    <td class="button set-slim" id="about" title="About" onclick="showDialog(dialogs.ABOUT)">‚ùì</td>
                </tr>
            </table>
        </div>
    </div>
    <div class="dialog-outer-container">
        <div class="dialog-background"></div>
        <div class="dialog-inner-container">
            <div class="dialog" id="welcome-dialog">
                <div class="dialog-title">New Str8ts-Game</div>
                <div style="margin-top: 10px" class="dialog-new">
                    <label for="grid-size-slider">Grid Size:</label>
                    <span id="grid-size">9</span>
                    <br/>
                    <input type="range" id="grid-size-slider" min="4" max="10" value="9"  class="slider" autocomplete="off" oninput="changeGenerateSize()"/>
                    <br/>
                    <label for="difficulty-slider">Difficulty:</label>
                    <span id="difficulty" class="difficulty">3</span>
                    <br>
                    <input type="range" min="1" max="4" value="3" id="difficulty-slider" class="slider" autocomplete="off" oninput="changeDifficulty()">
                </div>
                <span class="dialog-button full-width" id="generate-button" onclick="loadNewGame()">Generate new game</span>
                <span class="close-button" id="cancel-new-game" onclick="showDialog(false)" style="display: none;">√ó</span>
            </div>
            <div class="dialog" id="solution-dialog">
                <span class="close-button" onclick="showDialog(false)">√ó</span>
                <div class="dialog-title">Show Solution</div>
                <div class="dialog-text">Reveal the complete solution?</div>
                <span class="dialog-button full-width" onclick="solution()">Reveal</span>
            </div>
            <div class="dialog" id="restart-dialog">
                <span class="close-button" onclick="showDialog(false)">√ó</span>
                <div class="dialog-title">Start Over</div>
                <div class="dialog-text">Clear all numbers and notes?</div>
                <span class="dialog-button full-width"  onclick="restart()">Clear</span>
            </div>
            <div class="dialog loading-dialog" id="loading-dialog">
                <div class="loading-ring"></div>
                <div style="margin-top: 10px;">Generating new game,<br>please wait.</div>
            </div>
            <div class="dialog" id="about-dialog">
                <span class="close-button" onclick="showDialog(false)">√ó</span>
                <div class="dialog-title">Straights.Web <span id="version">0.6.18</span></div>
                <div>¬© 2020 Luis Walter, 2025 Moritz Ringler</div>
                <ul>
                <li>License: <a href="https://spdx.org/licenses/GPL-3.0-or-later.html">GPL 3 or later</a></li>
                <li><a href="https://github.com/m-ringler/straights">GitHub</a></li>
                <li><a href="https://en.wikipedia.org/wiki/Str8ts#Gameplay">How to play</a></li>
                <li><a href="." id="current-game">Current Game</a> <span class="copy-link" onclick="copyCurrentLink()" title="Copy link to clipboard">üîó</span></li>
                </ul>
                <div>
                <span
                   id="force-update"
                   class="dialog-button full-width"
                   style="display: none;"
                   onclick="showDialog(false)"
                   title="Force an update of the app. You may need to restart the app afterwards.">Update App</span>
                </div>
            </div>
            <div class="dialog" id="hint-dialog" onclick="closeHint()">
                <span class="close-button" onclick="closeHint()">√ó</span>
                <div id="hint-text"></div>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="str8ts.js" ></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./service-worker.js', {
                updateViaCache: "none",
            }).then(
                registration => {
                   console.log('Service Worker registered successfully.')
                   $('#force-update').show()
                   $('#force-update').on('click', () => {
                       registration.update().then(() => {
                           console.log('Service Worker update triggered.')
                       })
                   })
            }).then(() => {
                navigator.serviceWorker.addEventListener('message', event => {
                    if (event.data === 'reload') {
                        window.location.reload(true)
                    }
                })
            }).catch(error => {
                console.warn(
                    'Service Worker registration failed:',
                     error,
                     'Will run without service worker.')
            });
        }
    </script>
</body>
</html>
