<!doctype html>
<!--
SPDX-FileCopyrightText: 2020 Luis Walter, 2025-2026 Moritz Ringler

SPDX-License-Identifier: GPL-3.0-or-later
-->

<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
    <meta name="author" content="Moritz Ringler" />
    <meta name="keywords" content="Straights, Str8ts, Puzzle, Game, Grid" />
    <meta name="description" content="Play Straights online without ads." />
    <title>Str8ts</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" type="text/css" href="./str8ts.css" />
    <link rel="stylesheet" type="text/css" href="./slick/slick.min.css" />
    <link rel="stylesheet" type="text/css" href="./slick/slick-theme.min.css" />
    <link rel="icon" type="image/x-icon" href="./favicon.ico" />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="./favicon/favicon-16x16.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="48x48"
      href="./favicon/favicon-48x48.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="64x64"
      href="./favicon/favicon-64x64.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="128x128"
      href="./favicon/favicon-128x128.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="256x256"
      href="./favicon/favicon-256x256.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="192x192"
      href="./favicon/maskable_icon_x192.png"
    />
    <link rel="manifest" href="./site.webmanifest" />
  </head>
  <body>
    <script src="jquery-3.7.1.min.js"></script>
    <script src="slick/slick.min.js"></script>
    <div class="wrapper">
      <table class="container" cellspacing="0"></table>
      <div class="controls">
        <table cellspacing="5" id="buttons-small">
          <tr>
            <td class="button num-small" data-button="bn1" id="sbn1">1</td>
            <td class="button num-small" data-button="bn2" id="sbn2">2</td>
            <td class="button num-small" data-button="bn3" id="sbn3">3</td>
            <td class="button num-small" data-button="bn4" id="sbn4">4</td>
            <td class="button num-small" data-button="bn5" id="sbn5">5</td>
            <td class="button num-small" data-button="bn6" id="sbn6">6</td>
            <td class="button num-small" data-button="bn7" id="sbn7">7</td>
            <td class="button num-small" data-button="bn8" id="sbn8">8</td>
            <td class="button num-small" data-button="bn9" id="sbn9">9</td>
            <td class="button num-small" data-button="bn10" id="sbn10">10</td>
            <td class="button num-small" data-button="bn11" id="sbn11">11</td>
            <td class="button num-small" data-button="bn12" id="sbn12">12</td>
          </tr>
        </table>
        <table cellspacing="7" id="buttons-large">
          <tr>
            <td class="button num" data-button="bn1" id="bn1">1</td>
            <td class="button num" data-button="bn2" id="bn2">2</td>
            <td class="button num" data-button="bn3" id="bn3">3</td>
          </tr>
          <tr>
            <td class="button num" data-button="bn4" id="bn4">4</td>
            <td class="button num" data-button="bn5" id="bn5">5</td>
            <td class="button num" data-button="bn6" id="bn6">6</td>
          </tr>
          <tr>
            <td class="button num" data-button="bn7" id="bn7">7</td>
            <td class="button num" data-button="bn8" id="bn8">8</td>
            <td class="button num" data-button="bn9" id="bn9">9</td>
          </tr>
          <tr>
            <td class="button num" data-button="bn10" id="bn10">10</td>
            <td class="button num" data-button="bn11" id="bn11">11</td>
            <td class="button num" data-button="bn12" id="bn12">12</td>
          </tr>
        </table>
        <table cellspacing="7px">
          <tr>
            <td
              class="button set"
              id="undo-button"
              title="Undo [Ctrl+Z]"
              disabled
            >
              ‚éå
            </td>
            <td
              class="button set"
              id="toggle-notes-mode-button"
              title="Notes Mode [N]"
            >
              üìù
            </td>
          </tr>
        </table>
        <table cellspacing="7px">
          <tr>
            <td class="button set-slim" id="check-button" title="Check">‚úÖÔ∏è</td>
            <td class="button set-slim" id="show-hint-button" title="Hint">
              üí°
            </td>
            <td
              class="button set-slim"
              id="show-solution-button"
              title="Show solution"
            >
              üëÄ
            </td>
          </tr>
          <tr>
            <td class="counter-text set-slim" id="check-counter">0</td>
            <td class="counter-text set-slim" id="hint-counter">0</td>
            <td class="counter-text set-slim" id="time-counter">00:00</td>
          </tr>
        </table>
        <table cellspacing="7px">
          <tr>
            <td
              class="button set-slimmer"
              id="show-new-game-dialog-button"
              title="New game"
            >
              ‚ú®
            </td>
            <td
              class="button set-slimmer"
              id="show-history-dialog-button"
              title="History"
            >
              üïì
            </td>
            <td
              class="button set-slimmer"
              id="show-restart-dialog-button"
              title="Start over"
            >
              ‚ü≥
            </td>
            <td
              class="button set-slim"
              id="show-about-dialog-button"
              title="About"
            >
              ‚ùì
            </td>
          </tr>
        </table>
      </div>
    </div>
    <div class="dialog-outer-container">
      <div class="dialog-background"></div>
      <div class="dialog-inner-container">
        <div class="dialog" id="new-game-dialog">
          <div class="dialog-title">New Str8ts-Game</div>
          <div style="margin-top: 10px" class="dialog-new">
            <label for="grid-size-slider">Grid Size:</label>
            <span id="grid-size-text">9</span>
            <br />
            <input
              type="range"
              id="grid-size-slider"
              min="4"
              max="10"
              value="9"
              class="slider"
              autocomplete="off"
            />
            <br />
            <label for="difficulty-slider">Difficulty:</label>
            <span id="difficulty-text" class="difficulty">3</span>
            <br />
            <input
              type="range"
              min="1"
              max="4"
              value="3"
              id="difficulty-slider"
              class="slider"
              autocomplete="off"
            />
          </div>

          <div class="carousel"></div>

          <span class="dialog-button full-width" id="confirm-new-game-button"
            >Generate new game</span
          >
          <span
            class="close-button"
            id="cancel-new-game-button"
            style="display: none"
            >√ó</span
          >
        </div>
        <div class="dialog" id="solution-dialog">
          <span class="close-button">√ó</span>
          <div class="dialog-title">Show Solution</div>
          <div class="dialog-text">Reveal the complete solution?</div>
          <span
            class="dialog-button full-width"
            id="confirm-show-solution-button"
            >Reveal</span
          >
        </div>
        <div class="dialog" id="restart-dialog">
          <span class="close-button">√ó</span>
          <div class="dialog-title">Start Over</div>
          <div class="dialog-text">Clear all numbers and notes?</div>
          <span class="dialog-button full-width" id="confirm-restart-button"
            >Clear</span
          >
        </div>
        <div
          class="dialog generating-new-game-dialog"
          id="generating-new-game-dialog"
        >
          <div class="loading-ring"></div>
          <div style="margin-top: 10px">
            Generating new game,<br />please wait.
          </div>
        </div>
        <div class="dialog" id="about-dialog">
          <span class="close-button">√ó</span>
          <div class="dialog-title">
            Straights.Web <span id="version">0.8.0</span>
          </div>
          <div>¬© 2020 Luis Walter, 2025-2026 Moritz Ringler</div>
          <ul>
            <li>
              License:
              <a
                href="https://spdx.org/licenses/GPL-3.0-or-later.html"
                target="_blank"
                >GPL 3 or later</a
              >
            </li>
            <li>
              <a href="https://github.com/m-ringler/straights" target="_blank"
                >GitHub</a
              >
            </li>
            <li>
              <a
                href="https://github.com/m-ringler/straights/wiki/"
                target="rules"
                >How to play</a
              >
            </li>
            <li>
              <a href="." id="current-game-link">Current Game</a>
              <span
                id="copy-link-button"
                class="copy-link"
                title="Copy link to clipboard"
                >üîó</span
              >
            </li>
          </ul>
          <div>
            <span
              id="force-update"
              class="dialog-button full-width"
              style="display: none"
              title="Force an update of the app. You may need to restart the app afterwards."
              >Update App</span
            >
          </div>
        </div>
        <div class="dialog" id="history-dialog">
          <span class="close-button">√ó</span>
          <div class="dialog-title">History</div>
          <div id="history-div" class="history"></div>
        </div>
      </div>
    </div>
    <!-- In constrast to the other dialogs, this one is positioned relative to the page.
      -- Therefore, it's not placed inside the dialog container.  -->
    <div class="dialog" id="hint-dialog">
      <span class="close-button" id="hint-close">√ó</span>
      <div id="hint-text"></div>
    </div>

    <!-- Start the UI Controller -->
    <script type="module">
      import { UIController } from './str8ts.js';

      const ui = new UIController($, window);
      $(async () => ui.startAsync());
    </script>

    <!-- Register the Service Worker -->
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker
          .register('./service-worker.js', {
            updateViaCache: 'none',
          })
          .then((registration) => {
            console.log('Service Worker registered successfully.');
            $('#force-update').show();
            $('#force-update').on('click', () => {
              registration.update().then(() => {
                console.log('Service Worker update triggered.');
              });
            });
          })
          .then(() => {
            navigator.serviceWorker.addEventListener('message', (event) => {
              if (event.data === 'reload') {
                window.location.reload(true);
              }
            });
          })
          .catch((error) => {
            console.warn(
              'Service Worker registration failed:',
              error,
              'Will run without service worker.'
            );
          });
      }
    </script>
  </body>
</html>
